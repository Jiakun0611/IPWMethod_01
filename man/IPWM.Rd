% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/IPWM.R
\name{IPWM}
\alias{IPWM}
\title{Inverse Propensity Weighting Method (IPWM)}
\usage{
IPWM(
  sc,
  sp,
  y,
  weight,
  p_formula = NULL,
  method = NULL,
  zcol = NULL,
  cali = TRUE,
  maxit = 20,
  tol = 1e-04,
  verbose = FALSE
)
}
\arguments{
\item{sc}{Data frame. Convenience sample containing outcome and covariates.}

\item{sp}{Data frame (one-reference) or list of data frames (multi-reference)
representing reference probability sample(s).}

\item{y}{Character string. Name of the outcome variable in \code{sc}.}

\item{weight}{Character string (one-reference) or character vector (multi-reference)
specifying the weight variable(s) in \code{sp}.}

\item{p_formula}{Optional. Either a formula, or a list of formulas. If omitted,
the method will use main effects of existing variables directly.}

\item{method}{Character string. One of \code{"ALP"}, \code{"CLW"}, \code{"raking"},
or \code{"multi"}. If \code{sp} is a list, method is automatically set to \code{"multi"}.}

\item{zcol}{Optional character vector. Domain variable(s) for subset estimation
or stratified calibration.}

\item{cali}{Logical. Whether to perform pairwise pre-calibration in the
multi-reference case. Default is \code{TRUE}.}

\item{maxit}{Integer. Maximum number of Newton–Raphson iterations (default 20).}

\item{tol}{Numeric. Convergence tolerance for the Newton–Raphson algorithm (default 1e-4).}

\item{verbose}{Logical. To control output format for S3 object.}
}
\value{
An object of class \code{"IPWM"} containing the following elements:
\describe{
  \item{call}{Function call used to generate the result.}
  \item{method}{The IPW method applied ("ALP", "CLW", "raking", or "multi").}
  \item{mean, variance}{Estimated weighted mean and variance of the outcome.}
  \item{coefficients}{Estimated coefficients of the participation model.}
  \item{iterations}{Number of iterations used in estimation.}
  \item{variables}{Covariates included in the participation model.}
}

The object can be summarized with \code{summary()} to display key results.
}
\description{
A unified function for implementing inverse propensity weighting methods
to integrate convenience samples with one or multiple reference probability
samples. Supports three single-reference methods - Adjusted Logistic
Propensity (ALP), CLW, and Raking - as well as a multi-reference extension
that performs calibration (raking) with optional pairwise pre-calibration.
}
\details{
The function automatically detects whether the user provides one or multiple
reference samples. When \code{sp} is a list of data frames, the method is
internally set to \code{"multi"}.

The participation model can be specified via:
\itemize{
  \item A formula (e.g., \code{~ x1 + x2 + x3*x4}) for the one-reference case.
  \item A list of formulas for the multi-reference case.
}
}
\examples{
\dontrun{
# --- Example: One-reference case ---
set.seed(1)
sc <- data.frame(x1 = rnorm(100), x2 = rnorm(100), y = rnorm(100))
sp <- data.frame(x1 = rnorm(200), x2 = rnorm(200), wt = runif(200, 0.5, 2))

fit1 <- IPWM(
  sc = sc,
  sp = sp,
  y = "y",
  weight = "wt",
  p_formula = ~ x1 + x2,
  method = "ALP"
)

# --- Example: Multi-reference case ---
sp1 <- data.frame(x1 = rnorm(200), x2 = rnorm(200), wt_sp1 = runif(200))
sp2 <- data.frame(x3 = rnorm(300), x4 = rnorm(300), wt_sp2 = runif(300))

fit2 <- IPWM(
  sc = sc,
  sp = list(sp1, sp2),
  y = "y",
  weight = c("wt_sp1", "wt_sp2"),
  p_formula = list(~ x1 + x2, ~ x3 * x4),
  cali = TRUE
)
}

}
\seealso{
\code{\link{IPWM_One}}, \code{\link{IPWM_Multi_Raking}}, \code{\link{process_p_formula}}
}
